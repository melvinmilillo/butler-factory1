name: üßπ Git Conflicts Cleanup

on:
  workflow_dispatch:

jobs:
  cleanup-conflicts:
    permissions:
      contents: write
      
    runs-on: ubuntu-latest
    steps:
      - name: ‚¨áÔ∏è Checkout repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: ‚öôÔ∏è Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: üì¶ Install dependencies
        run: npm install

      - name: üßπ Clean Git Conflicts
        run: node emergency-git-cleanup.js

      - name: üöÄ Commit Cleanup
        run: |
          git config --global user.name 'GitHub Actions Bot'
          git config --global user.email 'actions-bot@github.com'
          
          if [[ -z $(git status --porcelain) ]]; then
            echo "‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –í—Å–µ —Ñ–∞–π–ª—ã —á–∏—Å—Ç—ã–µ."
            exit 0
          fi

          echo "üî• –ù–∞–π–¥–µ–Ω—ã –∏ —É–¥–∞–ª–µ–Ω—ã —Ñ–∞–π–ª—ã —Å Git –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏. –ü—É–±–ª–∏–∫—É—é..."
          git add .
          git commit -m "üßπ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ Git –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤"
          git pull --rebase
          git push
